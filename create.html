<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ResumeAI — Create Resume</title>
  <style>
    :root{
      --bg:#0b0f19;
      --panel: rgba(255,255,255,.03);
      --border: rgba(255,255,255,.10);
      --text:#e5e7eb;
      --muted:#9ca3af;
      --input:#111827;
      --accent1:#7b5cff;
      --accent2:#5b3dff;
    }
    body{margin:0;font-family:Inter,system-ui,Arial;background:var(--bg);color:var(--text)}
    .wrap{max-width:980px;margin:auto;padding:40px 20px}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    a.link{color:#a5b4fc;text-decoration:none;font-weight:600}
    h1{margin:14px 0 6px 0;font-size:42px;letter-spacing:-0.02em}
    .muted{color:var(--muted);font-size:13px;line-height:1.5}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px;margin-top:16px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    label{font-size:13px;color:var(--muted)}
    input,textarea,select{
      width:100%;padding:12px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);
      background:var(--input);color:var(--text);outline:none;
    }
    textarea{min-height:120px;resize:vertical}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:14px}
    button{
      padding:12px 16px;border:0;border-radius:12px;
      background:linear-gradient(135deg,var(--accent1),var(--accent2));
      color:#fff;font-weight:800;cursor:pointer;
    }
    button:disabled{opacity:.6;cursor:not-allowed}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding:10px 12px;border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.02);
    }
    .hint{margin-top:6px}
    .sectionTitle{margin:18px 0 6px 0;font-weight:800}
    .small{font-size:12px;color:rgba(255,255,255,.65)}
    @media(max-width:900px){.grid{grid-template-columns:1fr} h1{font-size:34px}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <a class="link" href="/index.html">← <span id="t_back">Back</span></a>
      <div class="pill">
        <span class="small" id="t_langLabel">Language</span>
        <select id="lang" style="width:auto;min-width:140px">
          <option value="en">English</option>
          <option value="tr">Türkçe</option>
          <option value="es">Español</option>
          <option value="ru">Русский</option>
          <option value="fr">Français</option>
          <option value="ar">العربية</option>
          <option value="zh">中文</option>
        </select>
      </div>
    </div>

    <h1 id="t_title">Create your resume</h1>
    <div class="muted" id="t_sub">
      Fill your details and generate an ATS-friendly resume PDF. (No AI rewriting here — we only format what you enter.)
    </div>

    <div class="card">
      <div class="grid">
        <div>
          <label id="t_fullname_label">Full name</label>
          <input id="fullName" placeholder="John Doe" />
        </div>
        <div>
          <label id="t_headline_label">Headline / Title</label>
          <input id="title" placeholder="Marketing Manager / Frontend Developer" />
        </div>

        <div>
          <label id="t_location_label">Location</label>
          <input id="location" placeholder="Istanbul, TR" />
        </div>
        <div>
          <label id="t_email_label">Email</label>
          <input id="email" placeholder="you@email.com" />
        </div>

        <div>
          <label id="t_phone_label">Phone</label>
          <input id="phone" placeholder="+90 ..." />
        </div>
        <div>
          <label id="t_links_label">Links (one per line: Label | URL)</label>
          <input id="links" placeholder="LinkedIn | https://linkedin.com/in/..." />
        </div>

        <div>
          <label id="t_skills_label">Skills (comma separated)</label>
          <input id="skills" placeholder="SEO, Google Analytics, SQL, Excel, ..." />
        </div>
        <div>
          <label id="t_langs_label">Languages (one per line: Language | Level)</label>
          <input id="langs" placeholder="English | Native&#10;Turkish | Native" />
        </div>
      </div>

      <div style="margin-top:14px">
        <div class="sectionTitle" id="t_summary_title">Summary (optional)</div>
        <label class="muted" id="t_summary_hint">
          Write 2–4 short bullet lines about your profile. (Example: “- 5+ years in digital marketing …”)
        </label>
        <textarea id="summary" placeholder="- ..."></textarea>
      </div>

      <div style="margin-top:14px">
        <div class="sectionTitle" id="t_exp_title">Work experience</div>
        <label class="muted" id="t_exp_hint">
          One job per block. Use either structured format OR simple lines.
        </label>
        <textarea id="experience" placeholder=
"Structured example:
Role: Marketing Manager
Company: ABC
Start: 2022
End: Present
Location: Remote
Bullets:
- What you did...
- What you achieved...

Simple example:
ABC Company
Marketing Manager
2022 - Present
- What you did...
- What you achieved..."
        ></textarea>
        <div class="muted hint" id="t_exp_hint2">
          Tip: Add 3–6 bullet lines per job (start with “- ”). No need for perfect English — just be clear.
        </div>
      </div>

      <div style="margin-top:14px">
        <div class="sectionTitle" id="t_edu_title">Education (optional)</div>
        <label class="muted" id="t_edu_hint">
          One item per block (School, Degree, Years). If you don’t have education, leave empty.
        </label>
        <textarea id="education" placeholder=
"University of X
BSc Computer Engineering
2016 - 2020

Yeditepe University
Business Administration
2010 - 2014"
        ></textarea>
      </div>

      <div style="margin-top:14px">
        <div class="sectionTitle" id="t_proj_title">Projects (optional)</div>
        <label class="muted" id="t_proj_hint">
          One project per block. Add name + technologies + 1–3 bullet lines.
        </label>
        <textarea id="projects" placeholder=
"ResumeAI.work
Tech: Next.js, Vercel, OpenAI API
- Built ATS analyzer
- Added PDF exports"
        ></textarea>
      </div>

      <div style="margin-top:14px">
        <div class="sectionTitle" id="t_cert_title">Certificates (optional)</div>
        <label class="muted" id="t_cert_hint">One per line.</label>
        <textarea id="certificates" placeholder="Google Analytics Certificate&#10;HubSpot Inbound Marketing"></textarea>
      </div>

      <div class="row">
        <button id="btn"><span id="t_btn">Generate CV + PDF</span></button>
        <div id="status" class="muted"></div>
      </div>
    </div>
  </div>

<script>
/** ---------- i18n ---------- **/
const I18N = {
  en: {
    back:"Back", langLabel:"Language",
    title:"Create your resume",
    sub:"Fill your details and generate an ATS-friendly resume PDF. (No AI rewriting here — we only format what you enter.)",
    fullname:"Full name", headline:"Headline / Title", location:"Location", email:"Email", phone:"Phone",
    links:"Links (one per line: Label | URL)",
    skills:"Skills (comma separated)",
    langs:"Languages (one per line: Language | Level)",
    summaryTitle:"Summary (optional)",
    summaryHint:"Write 2–4 short bullet lines about your profile. (Example: “- 5+ years in digital marketing …”)",
    expTitle:"Work experience",
    expHint:"One job per block. Use either structured format OR simple lines.",
    expHint2:"Tip: Add 3–6 bullet lines per job (start with “- ”). No need for perfect English — just be clear.",
    eduTitle:"Education (optional)",
    eduHint:"One item per block (School, Degree, Years). If you don’t have education, leave empty.",
    projTitle:"Projects (optional)",
    projHint:"One project per block. Add name + technologies + 1–3 bullet lines.",
    certTitle:"Certificates (optional)",
    certHint:"One per line.",
    btn:"Generate CV + PDF",
    done:"Done ✅ Opening CV…",
    err:"Error:"
  },
  tr: {
    back:"Geri", langLabel:"Dil",
    title:"CV oluştur",
    sub:"Bilgilerini doldur ve ATS uyumlu CV PDF’i oluştur. (Bu sayfada AI yok — sadece senin yazdıklarını düzenleyip yerleştiriyoruz.)",
    fullname:"Ad Soyad", headline:"Başlık / Ünvan", location:"Konum", email:"E-posta", phone:"Telefon",
    links:"Linkler (satır satır: Etiket | URL)",
    skills:"Yetenekler (virgülle ayır)",
    langs:"Diller (satır satır: Dil | Seviye)",
    summaryTitle:"Özet (opsiyonel)",
    summaryHint:"Kendini 2–4 kısa maddeyle anlat. (Örn: “- Dijital pazarlamada 5+ yıl …”)",
    expTitle:"İş deneyimi",
    expHint:"Her iş için ayrı blok. İstersen etiketli format, istersen düz satır formatı kullan.",
    expHint2:"İpucu: Her iş için 3–6 madde yaz (başına “- ” koy). Mükemmel cümle şart değil, net olsun yeter.",
    eduTitle:"Eğitim (opsiyonel)",
    eduHint:"Her eğitim için ayrı blok (Okul, Bölüm, Yıllar). Yoksa boş bırak.",
    projTitle:"Projeler (opsiyonel)",
    projHint:"Her proje için ayrı blok. İsim + teknolojiler + 1–3 madde yaz.",
    certTitle:"Sertifikalar (opsiyonel)",
    certHint:"Her satıra bir tane.",
    btn:"CV + PDF oluştur",
    done:"Tamam ✅ CV açılıyor…",
    err:"Hata:"
  },
  es: { back:"Atrás", langLabel:"Idioma", title:"Crea tu CV", sub:"Completa tus datos y genera un PDF ATS. (Sin reescritura AI — solo formateamos lo que ingresas.)",
    fullname:"Nombre completo", headline:"Título", location:"Ubicación", email:"Email", phone:"Teléfono",
    links:"Enlaces (una línea: Etiqueta | URL)", skills:"Habilidades (separadas por comas)", langs:"Idiomas (una línea: Idioma | Nivel)",
    summaryTitle:"Resumen (opcional)", summaryHint:"Escribe 2–4 líneas con viñetas.", expTitle:"Experiencia", expHint:"Un trabajo por bloque.",
    expHint2:"Consejo: 3–6 viñetas por trabajo.", eduTitle:"Educación (opcional)", eduHint:"Un ítem por bloque.", projTitle:"Proyectos (opcional)", projHint:"Un proyecto por bloque.",
    certTitle:"Certificados (opcional)", certHint:"Uno por línea.", btn:"Generar CV + PDF", done:"Listo ✅ Abriendo…", err:"Error:" },
  ru: { back:"Назад", langLabel:"Язык", title:"Создать резюме", sub:"Заполни данные и получи PDF (ATS). (Без AI-переписывания — только форматируем твой текст.)",
    fullname:"Имя", headline:"Должность", location:"Город", email:"Email", phone:"Телефон",
    links:"Ссылки (строка: Метка | URL)", skills:"Навыки (через запятую)", langs:"Языки (строка: Язык | Уровень)",
    summaryTitle:"Профиль (опц.)", summaryHint:"2–4 строки с “- ”.", expTitle:"Опыт", expHint:"Одна работа — один блок.", expHint2:"Совет: 3–6 буллетов на работу.",
    eduTitle:"Образование (опц.)", eduHint:"Один блок на пункт.", projTitle:"Проекты (опц.)", projHint:"Один блок на проект.",
    certTitle:"Сертификаты (опц.)", certHint:"Один на строку.", btn:"Создать CV + PDF", done:"Готово ✅ Открываю…", err:"Ошибка:" },
  fr: { back:"Retour", langLabel:"Langue", title:"Créer votre CV", sub:"Remplis tes infos et génère un PDF ATS. (Pas de réécriture AI — on formate seulement.)",
    fullname:"Nom complet", headline:"Titre", location:"Lieu", email:"Email", phone:"Téléphone",
    links:"Liens (ligne: Libellé | URL)", skills:"Compétences (séparées par des virgules)", langs:"Langues (ligne: Langue | Niveau)",
    summaryTitle:"Résumé (optionnel)", summaryHint:"2–4 lignes en puces.", expTitle:"Expérience", expHint:"Un poste par bloc.", expHint2:"Astuce: 3–6 puces par poste.",
    eduTitle:"Éducation (optionnel)", eduHint:"Un item par bloc.", projTitle:"Projets (optionnel)", projHint:"Un projet par bloc.",
    certTitle:"Certificats (optionnel)", certHint:"Un par ligne.", btn:"Générer CV + PDF", done:"Terminé ✅ Ouverture…", err:"Erreur:" },
  ar: { back:"رجوع", langLabel:"اللغة", title:"إنشاء السيرة الذاتية", sub:"املأ بياناتك وأنشئ PDF متوافق مع ATS. (بدون إعادة كتابة بالذكاء — فقط تنسيق.)",
    fullname:"الاسم الكامل", headline:"المسمى", location:"الموقع", email:"البريد", phone:"الهاتف",
    links:"روابط (سطر: اسم | رابط)", skills:"المهارات (مفصولة بفواصل)", langs:"اللغات (سطر: لغة | مستوى)",
    summaryTitle:"ملخص (اختياري)", summaryHint:"اكتب 2–4 نقاط.", expTitle:"الخبرة", expHint:"وظيفة واحدة لكل كتلة.", expHint2:"نصيحة: 3–6 نقاط لكل وظيفة.",
    eduTitle:"التعليم (اختياري)", eduHint:"عنصر لكل كتلة.", projTitle:"المشاريع (اختياري)", projHint:"مشروع لكل كتلة.",
    certTitle:"الشهادات (اختياري)", certHint:"واحدة لكل سطر.", btn:"إنشاء CV + PDF", done:"تم ✅ جارٍ الفتح…", err:"خطأ:" },
  zh: { back:"返回", langLabel:"语言", title:"创建简历", sub:"填写信息并生成 ATS 友好的 PDF。（不做 AI 改写，只做排版。）",
    fullname:"姓名", headline:"标题/职位", location:"地点", email:"邮箱", phone:"电话",
    links:"链接（每行：名称 | URL）", skills:"技能（逗号分隔）", langs:"语言（每行：语言 | 等级）",
    summaryTitle:"简介（可选）", summaryHint:"写 2–4 条要点。", expTitle:"工作经历", expHint:"每份工作一段。", expHint2:"建议：每份工作 3–6 条要点。",
    eduTitle:"教育（可选）", eduHint:"每条教育一段。", projTitle:"项目（可选）", projHint:"每个项目一段。",
    certTitle:"证书（可选）", certHint:"每行一个。", btn:"生成 CV + PDF", done:"完成 ✅ 正在打开…", err:"错误:" }
};

function applyLang(code){
  const t = I18N[code] || I18N.en;
  document.documentElement.lang = code;
  // quick RTL support
  document.documentElement.dir = (code === "ar") ? "rtl" : "ltr";

  const set = (id, val)=>{ const el=document.getElementById(id); if(el) el.textContent=val; };
  set("t_back", t.back);
  set("t_langLabel", t.langLabel);
  set("t_title", t.title);
  set("t_sub", t.sub);

  const setLabel = (id,val)=>{ const el=document.getElementById(id); if(el) el.textContent=val; };
  setLabel("t_fullname_label", t.fullname);
  setLabel("t_headline_label", t.headline);
  setLabel("t_location_label", t.location);
  setLabel("t_email_label", t.email);
  setLabel("t_phone_label", t.phone);
  setLabel("t_links_label", t.links);
  setLabel("t_skills_label", t.skills);
  setLabel("t_langs_label", t.langs);

  set("t_summary_title", t.summaryTitle);
  set("t_summary_hint", t.summaryHint);
  set("t_exp_title", t.expTitle);
  set("t_exp_hint", t.expHint);
  set("t_exp_hint2", t.expHint2);
  set("t_edu_title", t.eduTitle);
  set("t_edu_hint", t.eduHint);
  set("t_proj_title", t.projTitle);
  set("t_proj_hint", t.projHint);
  set("t_cert_title", t.certTitle);
  set("t_cert_hint", t.certHint);
  set("t_btn", t.btn);

  // store
  localStorage.setItem("resumeai_create_lang", code);
}

(function initLang(){
  const saved = localStorage.getItem("resumeai_create_lang");
  const select = document.getElementById("lang");
  if(saved && select) select.value = saved;
  applyLang(select?.value || "en");
  select?.addEventListener("change", ()=> applyLang(select.value));
})();

/** ---------- parsers (for flexible input) ---------- **/
const safe = (v)=> (v==null ? "" : String(v)).trim();

function splitBlocks(v){
  return String(v||"")
    .split(/\n\s*\n/)
    .map(b=>b.trim())
    .filter(Boolean)
    .slice(0, 20);
}

function lines(v){
  return String(v||"").split("\n").map(x=>x.trim()).filter(Boolean);
}

function parseLinks(v){
  return lines(v).slice(0,6).map(line=>{
    const parts = line.split("|").map(s=>s.trim());
    return { label: parts[0] || "Link", url: parts[1] || "" };
  }).filter(x=>x.url);
}

function parseLangs(v){
  return lines(v).slice(0,10).map(line=>{
    const parts = line.split("|").map(s=>s.trim());
    // allow "english-turkish-french" mistake -> treat as name only
    return { name: parts[0] || "", level: parts[1] || "" };
  }).filter(x=>x.name);
}

function parseBulletsFromLines(arr){
  // keep only lines starting with "-" as bullets
  const bullets = arr.filter(l => l.startsWith("-")).map(l => l.replace(/^\-\s*/, "").trim()).filter(Boolean);
  return bullets.slice(0, 10);
}

function parseExperience(v){
  const blocks = splitBlocks(v);

  return blocks.map(b=>{
    const get = (key)=>{
      const m = b.match(new RegExp("^"+key+"\\s*:\\s*(.+)$","im"));
      return m ? m[1].trim() : "";
    };

    const hasStructured = /Role\s*:|Company\s*:|Start\s*:|End\s*:|Location\s*:|Bullets\s*:/i.test(b);
    if(hasStructured){
      const bulletsPart = b.split(/Bullets\s*:/i)[1] || "";
      const bLines = lines(bulletsPart);
      const bullets = parseBulletsFromLines(bLines);

      const notes = get("Notes");
      const notesBullets = notes ? [notes] : [];

      return {
        position: get("Role"),
        company: get("Company"),
        start: get("Start"),
        end: get("End") || null,
        location: get("Location"),
        highlights: bullets.length ? bullets : notesBullets
      };
    }

    // simple format:
    // 1: company, 2: role, 3: dates, rest: bullets
    const l = lines(b);
    const company = l[0] || "";
    const position = l[1] || "";
    const dates = l[2] || "";
    const rest = l.slice(3);

    let start = "", end = null;
    const dm = dates.match(/(\d{4}|\d{2}\/\d{4})\s*[-–]\s*(present|now|\d{4}|\d{2}\/\d{4})/i);
    if(dm){
      start = dm[1];
      end = (String(dm[2]).toLowerCase().includes("present") || String(dm[2]).toLowerCase().includes("now")) ? null : dm[2];
    }else{
      // if user only wrote one year range like "2019-2025"
      const ym = dates.match(/(\d{4})\s*[-–]\s*(\d{4})/);
      if(ym){ start = ym[1]; end = ym[2]; }
    }

    const bullets = parseBulletsFromLines(rest);

    return {
      position,
      company,
      start,
      end,
      location: "",
      highlights: bullets
    };
  }).filter(x => x.company || x.position).slice(0, 10);
}

function parseEducation(v){
  const blocks = splitBlocks(v);
  return blocks.map(b=>{
    const l = lines(b);
    // try structured
    const school = (b.match(/^School\s*:\s*(.+)$/im)?.[1] || l[0] || "").trim();
    const degree = (b.match(/^Degree\s*:\s*(.+)$/im)?.[1] || l[1] || "").trim();
    const years = l.find(x=>/\d{4}/.test(x)) || "";
    let start="", end="";
    const m = years.match(/(\d{4}).*[-–].*(\d{4})/);
    if(m){ start=m[1]; end=m[2]; }
    return { school, degree, start, end };
  }).filter(x=>x.school || x.degree).slice(0, 10);
}

function parseProjects(v){
  const blocks = splitBlocks(v);
  return blocks.map(b=>{
    const get = (key)=>{
      const m = b.match(new RegExp("^"+key+"\\s*:\\s*(.+)$","im"));
      return m ? m[1].trim() : "";
    };
    const l = lines(b);
    const name = get("Name") || l[0] || "";
    const techLine = get("Tech") || (l.find(x=>/^Tech\s*:/i.test(x)) || "");
    const techStr = techLine.replace(/^Tech\s*:\s*/i,"").trim();
    const tech = techStr ? techStr.split(",").map(x=>x.trim()).filter(Boolean).slice(0,10) : [];
    const bullets = parseBulletsFromLines(l);
    return { name, tech, highlights: bullets };
  }).filter(x=>x.name).slice(0, 8);
}

function parseCertificates(v){
  return lines(v).slice(0, 15);
}

/** ---------- action ---------- **/
document.getElementById("btn").addEventListener("click", ()=>{
  const btn = document.getElementById("btn");
  const status = document.getElementById("status");
  const lang = document.getElementById("lang").value;
  const t = I18N[lang] || I18N.en;

  btn.disabled = true;
  status.textContent = "Saving…";

  try{
    const basics = {
      fullName: safe(document.getElementById("fullName").value),
      title: safe(document.getElementById("title").value),
      location: safe(document.getElementById("location").value),
      phone: safe(document.getElementById("phone").value),
      email: safe(document.getElementById("email").value),
      links: parseLinks(document.getElementById("links").value),
      photoUrl: ""
    };

    const cv_data = {
      basics,
      summary: safe(document.getElementById("summary").value),
      skills: safe(document.getElementById("skills").value)
        .split(",").map(x=>x.trim()).filter(Boolean).slice(0,30)
        .map(name => ({ name, level:"" })),
      experience: parseExperience(document.getElementById("experience").value).map(e=>({
        company: safe(e.company),
        position: safe(e.position),
        start: safe(e.start),
        end: e.end == null ? null : safe(e.end),
        location: safe(e.location),
        highlights: (Array.isArray(e.highlights)? e.highlights : []).map(x=>String(x||"").trim()).filter(Boolean).slice(0,10)
      })),
      projects: parseProjects(document.getElementById("projects").value),
      education: parseEducation(document.getElementById("education").value),
      certificates: parseCertificates(document.getElementById("certificates").value),
      languages: parseLangs(document.getElementById("langs").value),
      meta: { accent: "#6366F1", includePhoto: false, lang }
    };

    localStorage.setItem("resumeai_cvdata", JSON.stringify(cv_data));
    status.textContent = t.done;
    window.location.href = `/cv.html?lang=${encodeURIComponent(lang)}#mode=ats`;
  }catch(e){
    status.textContent = `${t.err} ${(e && e.message) ? e.message : String(e)}`;
  }finally{
    btn.disabled = false;
  }
});
</script>
</body>
</html>
